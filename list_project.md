# ğŸ“˜ AI é©±åŠ¨å¤šå¸ç§é€ä»“é‡åŒ–äº¤æ˜“ç³»ç»Ÿéœ€æ±‚æ–‡æ¡£ (V8.0 ä¼ä¸šçº§æ¶æ„ç‰ˆ)

**æ–‡æ¡£ç‰ˆæœ¬:** V8.0
**æ—¥æœŸ:** 2026-01-06
**é¡¹ç›®ä»£å·:** Alpha-Sniper-V8
**æ ¸å¿ƒç›®æ ‡:** åˆ©ç”¨ 500 USDT æœ¬é‡‘ï¼Œé€šè¿‡é«˜èƒœç‡è¶‹åŠ¿äº¤æ˜“ä¸ AI ä¼˜é€‰ï¼Œå®ç°å‘¨ç›ˆåˆ© 100U - 200U (20% - 40% ROI)ã€‚

---

## 1. ç³»ç»Ÿæ¶æ„ä¸è¿è¡Œæ—¶ (System Architecture & Runtime)

æœ¬ç‰ˆæœ¬é‡‡ç”¨å¾®æœåŠ¡æ¶æ„æ€æƒ³ï¼Œç¡®ä¿é«˜å¯ç”¨æ€§ã€å¯è§‚æµ‹æ€§ä¸è‡ªæ„ˆèƒ½åŠ›ã€‚

### 1.1 å®¹å™¨åŒ–è¿›ç¨‹ç®¡ç† (Process Management)
* **åŸºç¡€é•œåƒ:** Python 3.10 (Slim/Alpine)ã€‚
* **è¿›ç¨‹ç¼–æ’:** ä½¿ç”¨ `Supervisor` åœ¨å®¹å™¨å†…ç®¡ç†å¤šè¿›ç¨‹ï¼Œæ›¿ä»£å•ä¸€è„šæœ¬è¿è¡Œã€‚
    * **Process A (Strategy Engine):** æ ¸å¿ƒäº¤æ˜“ä¸»å¾ªç¯ï¼Œè´Ÿè´£ä¿¡å·è®¡ç®—ä¸ä¸‹å•ã€‚
    * **Process B (API Service):** æä¾› Healthcheckã€Metrics å’Œ Admin æ¥å£ã€‚
    * **Process C (Data Syncer):** ç‹¬ç«‹è´Ÿè´£ K çº¿æ¸…æ´—ã€æŒ‡æ ‡é¢„è®¡ç®—ç¼“å­˜ã€å†å²æ•°æ®å½’æ¡£ã€‚
* **è‡ªæ„ˆæœºåˆ¶ (Self-Healing):**
    * `Supervisor` é…ç½® `autorestart=true`ï¼Œè¿›ç¨‹å´©æºƒæ¯«ç§’çº§æ‹‰èµ·ã€‚
    * `Docker Healthcheck` æ¯ 30s è¯·æ±‚ API ç«¯ç‚¹ï¼Œè¶…æ—¶è‡ªåŠ¨é‡å¯å®¹å™¨ã€‚

### 1.2 ç›‘æ§ä¸å‘Šè­¦ (Observability)
* **Healthcheck:** æš´éœ² `GET /health` ç«¯ç‚¹ï¼Œè¿”å›å„å­è¿›ç¨‹çŠ¶æ€ã€‚
* **Alerting:** è¿›ç¨‹é‡å¯æˆ–å®¹å™¨é‡å¯æ—¶ï¼Œé€šè¿‡ Telegram Bot å‘é€ "âš ï¸ Critical System Event" å‘Šè­¦ã€‚

---

## 2. æ•°æ®åº“è®¾è®¡ï¼šé«˜æ€§èƒ½ä¸å®¡è®¡ (Database Schema)

é‡‡ç”¨ **MariaDB**ï¼Œé’ˆå¯¹é«˜é¢‘è¯»å†™ã€å®¡è®¡æº¯æºè¿›è¡Œæ·±åº¦ä¼˜åŒ–ã€‚

### 2.1 é«˜æ€§èƒ½å­˜å‚¨ (Performance)
* **åˆ†åŒºè¡¨ (Partitioning):**
    * **Table:** `trade_logs`
    * **ç­–ç•¥:** æŒ‰ `timestamp` è¿›è¡Œ RANGE åˆ†åŒº (æŒ‰æœˆ `p_202601`, `p_202602`...)ã€‚
    * **ç›®çš„:** æå‡å†å²ä¸šç»©æŸ¥è¯¢ä¸å›æµ‹é€Ÿåº¦ã€‚
* **é¢„è®¡ç®—ç¼“å­˜ (Caching):**
    * **Table:** `market_data_cache`
    * **å†…å®¹:** å­˜å‚¨é¢„è®¡ç®—å¥½çš„ ADX, Squeeze Momentum, EMA ç­‰æŒ‡æ ‡ã€‚
    * **ç­–ç•¥:** ç­–ç•¥å¼•æ“ä¼˜å…ˆè¯»å–ç¼“å­˜ï¼Œå‡å°‘å®æ—¶è®¡ç®— CPU æ¶ˆè€—ã€‚

### 2.2 å®¡è®¡ä¸äº‹ä»¶æµ (Auditability)
* **ä¸å¯å˜äº‹ä»¶æµ (Event Sourcing):**
    * **Table:** `order_events`
    * **è®°å½•:** è®¢å•å…¨ç”Ÿå‘½å‘¨æœŸ (CREATED -> SUBMITTED -> FILLED -> CANCELED)ã€‚
    * **å­—æ®µ:** `event_id`, `order_id`, `type`, `timestamp`, `raw_payload` (äº¤æ˜“æ‰€åŸå§‹å“åº”)ã€‚
* **æŒä»“å¿«ç…§ (Snapshots):**
    * **Table:** `position_snapshots`
    * **é¢‘ç‡:** æ¯ 5 åˆ†é’Ÿæˆ–å…³é”®äº‹ä»¶è§¦å‘ã€‚
    * **ç”¨é€”:** å®Œç¾å¤ç›˜æŒä»“è¿‡ç¨‹ä¸­çš„æµ®ç›ˆå›æ’¤ä¸ä¿è¯é‡‘å˜åŒ–ã€‚

### 2.3 è‡ªåŠ¨å½’æ¡£ (Archiving)
* **ç­–ç•¥:** ä»…ä¿ç•™æœ€è¿‘ 90 å¤©çš„çƒ­æ•°æ®ã€‚
* **ä»»åŠ¡:** æ¯æ—¥å‡Œæ™¨è¿è¡Œå½’æ¡£ä»»åŠ¡ï¼Œå°†æ—§æ•°æ®ç§»åŠ¨è‡³ `_history` è¡¨ã€‚

---

## 3. èµ„é‡‘ç®¡ç†ä¸é£æ§ (Capital & Risk Management)

### 3.1 åŠ¨æ€â€œåœ°æ¿â€ä¿è¯é‡‘ (Dynamic Floor Margin)
* **æ ¸å¿ƒé€»è¾‘:** å•ç¬”äº¤æ˜“ **Initial Margin (åˆå§‹ä¿è¯é‡‘)** $\ge$ **50 USDT**ã€‚
* **è®¡ç®—å…¬å¼:**
    * `Base_Margin = Equity * 10%`
    * `Final_Margin = max(50, Base_Margin)`
    * *AI å¢å¼º:* è‹¥ AI Score > 85ï¼Œç³»æ•°å¯æ”¾å¤§è‡³ 1.2ã€‚
* **é£æ§çº¦æŸ:**
    * è‹¥ `Final_Margin * æ æ† * æ­¢æŸè·ç¦»% > Total_Equity * 3%`ï¼Œç³»ç»Ÿä¼˜å…ˆ**é™ä½æ æ†**ã€‚
    * è‹¥æ æ†é™è‡³ 5x ä»æ— æ³•æ»¡è¶³é£æ§ï¼Œåˆ™æ”¾å¼ƒè¯¥å•ã€‚

### 3.2 å¼ºå¹³è·ç¦»ç¡¬çº¦æŸ (Liquidation Guard)
* **æ¨¡å¼:** **å¼ºåˆ¶é€ä»“ (Isolated Margin)**ã€‚
* **æ æ†èŒƒå›´:** **10x - 20x** (åŠ¨æ€è°ƒæ•´)ã€‚
* **ç¡¬æ€§æ£€æŸ¥å…¬å¼:**
    $$|Entry - Liq\_Price| > 1.5 \times |Entry - Stop\_Loss|$$
    * *æ‰§è¡Œ:* ä¸‹å•å‰é¢„è®¡ç®—ã€‚å¦‚æœä¸æ»¡è¶³ï¼Œè‡ªåŠ¨é™æ æ†é‡ç®—ã€‚

---

## 4. ç­–ç•¥æ ¸å¿ƒé€»è¾‘ (Strategy Engine)

### 4.1 è¶‹åŠ¿ä¸åŠ¨é‡è¿‡æ»¤
1.  **ADX è¶‹åŠ¿å¼ºåº¦:** `ADX(14) > 25` ä¸” `+DI > -DI` (åšå¤š)ã€‚
2.  **æŒ¤å‹åŠ¨é‡ (Squeeze Momentum):**
    * **Squeeze Release:** çŠ¶æ€ç”± `On` (æŒ¤å‹) å˜ä¸º `Off` (é‡Šæ”¾)ã€‚
    * **Momentum:** æŸ±çŠ¶å›¾ç”±è´Ÿè½¬æ­£ (åšå¤š)ã€‚
3.  **æˆäº¤é‡ç¡®è®¤:** `Current_Vol > 1.5 * MA(Vol, 5)`ã€‚

### 4.2 å…¥åœºæ¨¡å‹ç»„åˆ (15m Timeframe)
* **Setup A (Trend Pullback):**
    * ç¯å¢ƒ: ADX > 25 (å¼ºè¶‹åŠ¿)ã€‚
    * è§¦å‘: å›è¸© EMA21/55 + æ‹’ç»Kçº¿ (Wick) + åæ²¡å½¢æ€ã€‚
* **Setup B (Squeeze Breakout):**
    * ç¯å¢ƒ: Squeeze Release + Momentum ç¿»çº¢ä¸ºç»¿ + é‡èƒ½çˆ†å‘ã€‚

---

## 5. AI æ™ºèƒ½å¤§è„‘ (AI Optimization)

* **æ¨¡å‹:** `SGDClassifier` (Scikit-learn, æ”¯æŒå¢é‡å­¦ä¹ )ã€‚
* **æ•°æ®æº:** `market_data_cache` (ç‰¹å¾) + `trade_logs` (æ ‡ç­¾)ã€‚
* **ç‰¹å¾å·¥ç¨‹:**
    * `ADX_Value`, `Squeeze_Status` (0/1/2), `Vol_Ratio`, `BTC_Correlation`, `RSI_Slope`ã€‚
* **è®­ç»ƒæœºåˆ¶:** æ¯æ¬¡å¹³ä»“ (Close Event) è§¦å‘ä¸€æ¬¡ `partial_fit` æ›´æ–°æ¨¡å‹æƒé‡ã€‚

---

## 6. ç®¡ç†ä¸äº¤äº’ (Admin Ops)

### 6.1 Admin Tool (CLI)
é€šè¿‡ Docker exec è¿è¡Œç®¡ç†å·¥å…·ï¼Œæ— éœ€é‡å¯å®¹å™¨ï¼š
```bash
python admin.py status          # æŸ¥çœ‹è¿›ç¨‹ä¸æŒä»“
python admin.py update_config   # çƒ­ä¿®æ”¹å‚æ•°
python admin.py emergency_exit  # ä¸€é”®æ¸…ä»“